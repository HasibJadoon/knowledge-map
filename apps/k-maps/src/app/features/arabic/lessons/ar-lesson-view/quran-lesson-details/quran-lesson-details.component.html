<div class="quran-section mb-4">
  <h6 class="card-title section-heading">Qur'anic Passage</h6>
  <hr class="section-divider" />
  <div *ngIf="!hasUnits" class="text-muted">No verse data available.</div>
  <div class="unit-card" *ngFor="let unit of arabicUnits; let last = last">
    <div class="arabic-text">{{ unit.arabic }}</div>
    <div class="text-muted" *ngIf="unit.translation">{{ unit.translation }}</div>
    <div class="unit-meta small" *ngIf="formatMeta(unit)">
      {{ formatMeta(unit) }}
    </div>
    <div class="text-muted small" *ngIf="unit.notes">{{ unit.notes }}</div>
    <hr *ngIf="!last" class="mini-neon-divider" />
  </div>
  <div class="text-muted small mt-2" *ngIf="text.reference">Reference: {{ text.reference }}</div>
</div>

<div class="sentences-section mb-4" *ngIf="text.sentences?.length">
  <h6 class="card-title section-heading">Sentence Highlights</h6>
  <hr class="section-divider" />
  <ul class="list-unstyled">
    <li *ngFor="let sentence of text.sentences">
      <div class="arabic-inline" *ngIf="sentence?.arabic">{{ sentence.arabic }}</div>
    </li>
  </ul>
</div>

  <div class="comprehension-section mb-4" *ngIf="reflectiveQuestions.length">
    <h6 class="card-title section-heading">Reflective Questions</h6>
    <hr class="section-divider" />
    <div class="comp-card" *ngFor="let item of reflectiveQuestions">
      <div class="arabic-question" *ngIf="item?.['question_ar']">{{ item['question_ar'] }}</div>
      <div class="question-text">{{ item?.['question'] }}</div>
      <p class="text-muted" *ngIf="item?.['answer_hint']">{{ item['answer_hint'] }}</p>
      <div class="tags" *ngIf="item?.['tags']?.length">{{ formatTags(item['tags']) }}</div>
      <div class="text-muted small" *ngIf="item?.['quranic_ref']">Ref: {{ item['quranic_ref'] }}</div>
    </div>
  </div>

  <div class="comprehension-section mb-4" *ngIf="analyticalQuestions.length">
    <h6 class="card-title section-heading">Analytical Questions</h6>
    <hr class="section-divider" />
    <div class="comp-card" *ngFor="let item of analyticalQuestions">
      <div class="arabic-question" *ngIf="item?.['question_ar']">{{ item['question_ar'] }}</div>
      <div class="question-text">{{ item?.['question'] }}</div>
      <p class="text-muted" *ngIf="item?.['answer_hint']">{{ item['answer_hint'] }}</p>
      <div class="tags" *ngIf="item?.['tags']?.length">{{ formatTags(item['tags']) }}</div>
      <div class="text-muted small" *ngIf="item?.['quranic_ref']">Ref: {{ item['quranic_ref'] }}</div>
    </div>
  </div>

<div class="mcq-section" *ngIf="mcqKeys.length">
  <h6 class="card-title section-heading">MCQs</h6>
  <hr class="section-divider" />
  <div *ngFor="let key of mcqKeys">
    <div class="mb-3">
      <div class="memory-label">{{ mcqLabel(key) }}</div>
      <div class="comp-card" *ngFor="let mcq of mcqGroups[key]">
        <div class="question-text">{{ mcq?.['question'] }}</div>
        <ul class="list-unstyled mcq-options">
          <li *ngFor="let option of mcq?.['options']" [class.correct]="option?.['is_correct']">
            {{ option?.['option'] }}
          </li>
        </ul>
        <div class="text-muted small" *ngIf="mcq?.['explanation']">{{ mcq['explanation'] }}</div>
        <div class="text-muted small" *ngIf="mcq?.['tags']?.length">Tags: {{ formatTags(mcq['tags']) }}</div>
      </div>
    </div>
  </div>
</div>

<div class="text-muted small" *ngIf="!reflectiveQuestions.length && !analyticalQuestions.length && !mcqKeys.length">
  No comprehension data yet.
</div>
