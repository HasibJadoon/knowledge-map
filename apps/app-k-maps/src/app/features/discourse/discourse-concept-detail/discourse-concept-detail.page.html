<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/discourse/wv_concepts"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ concept?.label_ar || 'Concept' }}</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content *ngIf="concept as c">
  <div class="ion-padding">
    <h2 class="ion-no-margin">{{ c.label_ar }}</h2>
    <p class="ion-no-margin">{{ c.label_en }}</p>
    <p class="ion-margin-top">Category: {{ c.category }}</p>
  </div>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Definition</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      {{ c.definition }}
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Qur'an Evidence (Primary)</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list lines="none">
        <ion-item *ngFor="let item of c.quranEvidence">
          <ion-label>
            <h3>{{ item.ref }} — {{ item.snippet }}</h3>
            <p>{{ item.note }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Qur'anic Concept Flow</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="flow">
        <div *ngFor="let node of c.flow; let last = last">
          <div class="flow-node">{{ node }}</div>
          <div *ngIf="!last" class="flow-arrow">↓</div>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Other Discourses (Secondary)</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div *ngFor="let block of c.otherDiscourses" class="ion-margin-bottom">
        <h3 class="ion-no-margin">{{ block.name }}</h3>
        <ul>
          <li *ngFor="let item of block.bullets">{{ item }}</li>
        </ul>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Qur'an Relation (Criterion)</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list lines="none">
        <ion-item
          *ngFor="let rel of c.relations"
          detail="true"
          button="true"
          (click)="openRelation(rel.id)"
        >
          <ion-label>
            <h3>{{ rel.source }}</h3>
            <p>{{ rel.summary }}</p>
          </ion-label>
          <ion-badge slot="end" [color]="relationColor(rel.status)">
            {{ relationLabel(rel.status) }}
          </ion-badge>
        </ion-item>
        <ion-item *ngIf="c.relations.length === 0">
          <ion-label>No relations yet.</ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Cross References</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ul>
        <li *ngFor="let ref of c.crossRefs">{{ ref }}</li>
      </ul>
    </ion-card-content>
  </ion-card>
</ion-content>
